# Лабораторная работа №17: Лямбда-выражения

## Теория

### Лямбда-выражения (Lambda Expressions)

Лямбда-выражения - это анонимные функции, которые можно использовать для создания делегатов или деревьев выражений. Они позволяют писать более компактный и читаемый код.

#### Синтаксис лямбда-выражений

```csharp
// Простое лямбда-выражение
Func<int, int> square = x => x * x;

// Лямбда-выражение с несколькими параметрами
Func<int, int, int> add = (x, y) => x + y;

// Лямбда-выражение с блоком кода
Func<int, bool> isEven = x => 
{
    return x % 2 == 0;
};
```

#### Типы лямбда-выражений

1. **Expression Lambda** - простое выражение
   ```csharp
   x => x * x
   ```

2. **Statement Lambda** - блок кода
   ```csharp
   x => 
   {
       if (x < 0) return 0;
       return x * x;
   }
   ```

#### Встроенные делегаты

```csharp
// Func<T> - возвращает значение
Func<int, int> square = x => x * x;

// Action<T> - не возвращает значение
Action<string> print = message => Console.WriteLine(message);

// Predicate<T> - возвращает bool
Predicate<int> isPositive = x => x > 0;
```

#### Использование с LINQ

```csharp
var numbers = new[] { 1, 2, 3, 4, 5 };

// Фильтрация
var evenNumbers = numbers.Where(n => n % 2 == 0);

// Преобразование
var squares = numbers.Select(n => n * n);

// Проверка условий
bool hasEven = numbers.Any(n => n % 2 == 0);
bool allPositive = numbers.All(n => n > 0);
```

### Расширяющие методы (Extension Methods)

Расширяющие методы позволяют добавлять новые методы к существующим типам без изменения исходного кода.

#### Синтаксис

```csharp
public static class StringExtensions
{
    public static string Reverse(this string str)
    {
        return new string(str.Reverse().ToArray());
    }
}
```

#### Использование

```csharp
string text = "Hello";
string reversed = text.Reverse(); // Вызов расширяющего метода
```

### Замыкания (Closures)

Лямбда-выражения могут захватывать переменные из внешней области видимости:

```csharp
int factor = 2;
Func<int, int> multiply = x => x * factor;
Console.WriteLine(multiply(5)); // Выведет 10
```

## Лучшие практики

### 1. Читаемость кода
```csharp
// Плохо
var result = list.Where(x => x > 0).Select(x => x * x).Where(x => x < 100);

// Хорошо
var result = list
    .Where(x => x > 0)
    .Select(x => x * x)
    .Where(x => x < 100);
```

### 2. Именование параметров
```csharp
// Плохо
var users = people.Where(p => p.Age > 18);

// Хорошо
var users = people.Where(person => person.Age > 18);
```

### 3. Избегание побочных эффектов
```csharp
// Плохо
var result = numbers.Select(n => 
{
    Console.WriteLine(n); // Побочный эффект
    return n * 2;
});

// Хорошо
var result = numbers.Select(n => n * 2);
```

### 4. Использование встроенных делегатов
```csharp
// Вместо создания собственного делегата
public delegate bool NumberPredicate(int number);

// Используйте встроенный
Func<int, bool> numberPredicate = n => n > 0;
```

## Примеры использования

### Фильтрация коллекций
```csharp
var products = GetProducts();
var expensiveProducts = products.Where(p => p.Price > 100);
var electronics = products.Where(p => p.Category == "Electronics");
```

### Сортировка
```csharp
var sortedProducts = products
    .OrderBy(p => p.Name)
    .ThenBy(p => p.Price);
```

### Группировка
```csharp
var groupedProducts = products
    .GroupBy(p => p.Category)
    .Select(g => new { Category = g.Key, Count = g.Count() });
```

### Агрегация
```csharp
var totalPrice = products.Sum(p => p.Price);
var averagePrice = products.Average(p => p.Price);
var maxPrice = products.Max(p => p.Price);
```

## Преимущества лямбда-выражений

1. **Компактность** - меньше кода для написания
2. **Читаемость** - код становится более понятным
3. **Функциональное программирование** - поддержка функционального стиля
4. **LINQ** - основа для Language Integrated Query
5. **Производительность** - оптимизированные компилятором

## Недостатки

1. **Сложность отладки** - сложнее отлаживать анонимные функции
2. **Читаемость** - при сложной логике может снижаться
3. **Производительность** - накладные расходы на создание делегатов

## Заключение

Лямбда-выражения являются мощным инструментом современного C#, который значительно упрощает работу с коллекциями, делегатами и функциональным программированием. Правильное использование лямбда-выражений делает код более читаемым, компактным и функциональным. 